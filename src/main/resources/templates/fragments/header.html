<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="header">

    <header class="navbar">
        <button class="menu-btn" id="menuToggle">☰</button>
        <div class="site-title">⚡ EV Trading</div>
        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
             alt="user" class="user-avatar" id="userAvatar">
    </header>

    <!-- Side Menu -->
    <nav class="side-menu" id="sideMenu">
        <a href="/" class="menu-item">Trang chủ</a>
        <a href="/" class="menu-item">Bảng tin</a>

        <!-- Guest -->
        <div th:if="${session.user == null}">
            <a href="/market" class="menu-item">Thị trường xe</a>
            <a href="/battery" class="menu-item">Thị trường pin</a>
            <a href="/admin" class="menu-item">Quản trị</a>
            <a href="/about" class="menu-item">Giới thiệu</a>
        </div>

        <!-- USER -->
        <div th:if="${session.user != null && session.user.role == 'USER'}">
            <a href="/market" class="menu-item">Thị trường xe</a>
            <a href="/battery" class="menu-item">Thị trường pin</a>
            <a href="/transactions" class="menu-item">Giao dịch</a>
            <a href="/about" class="menu-item">Giới thiệu</a>
        </div>

        <!-- ADMIN -->
        <div th:if="${session.user != null && session.user.role == 'ADMIN'}">
            <a href="/admin/dashboard" class="menu-item">Quản trị</a>
            <a href="/complaints" class="menu-item">Khiếu nại</a>
            <a href="/statistics" class="menu-item">Thống kê</a>
            <a href="/about" class="menu-item">Giới thiệu</a>
        </div>
    </nav>

    <!-- User Dropdown -->
    <div class="dropdown" id="userDropdown">

        <!-- Guest -->
        <div th:if="${session.user == null}">
            <a href="/login" class="dropdown-item">Đăng nhập</a>
            <a href="/register" class="dropdown-item">Đăng ký</a>
            <a href="/forgot-password" class="dropdown-item">Quên mật khẩu</a>
            <!-- Không có Bảng tin ở đây nữa -->
        </div>

        <!-- USER -->
        <div th:if="${session.user != null && session.user.role == 'USER'}">
            <a href="/profile" class="dropdown-item"
               th:text="${session.user.name}"></a>
            <!-- Chỉ còn Đăng tin mới + Đăng xuất -->
            <a href="/posts/new" class="dropdown-item">Đăng tin mới</a>
            <a href="/logout" class="dropdown-item">Đăng xuất</a>
        </div>

        <!-- ADMIN -->
        <div th:if="${session.user != null && session.user.role == 'ADMIN'}">
            <a href="/admin/dashboard" class="dropdown-item">Dashboard</a>
            <a href="/logout" class="dropdown-item">Đăng xuất</a>
        </div>
    </div>

</div>

</body>
</html>
