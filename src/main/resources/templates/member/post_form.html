<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Đăng tin</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script th:src="@{/js/script.js}" defer></script>
</head>
<body>

<!-- Header -->
<div th:replace="fragments/header :: header"></div>

<div class="auth-wrapper">
    <div class="auth-box" style="max-width:680px;">
        <h2 th:text="${post.id == null ? 'Đăng tin mới' : 'Cập nhật tin'}"></h2>

        <form th:action="${post.id == null} ? @{/posts} : @{'/posts/' + ${post.id}}"
              method="post"
              enctype="multipart/form-data"
              class="auth-form">

            <!-- TIÊU ĐỀ -->
            <div class="form-group">
                <label>Tiêu đề</label>
                <input type="text" name="title" th:value="${post.title}" required>
            </div>

            <!-- DANH MỤC -->
            <div class="form-group">
                <label>Danh mục</label>
                <input type="text"
                       name="category"
                       th:value="${post.category}"
                       placeholder="Ví dụ: EV, PIN, Xe điện, Pin năng lượng...">
            </div>

            <!-- ĐỊA ĐIỂM -->
            <div class="form-group">
                <label>Địa điểm</label>
                <input type="text"
                       name="location"
                       th:value="${post.location}"
                       placeholder="Ví dụ: Hồ Chí Minh">
            </div>

            <!-- GIÁ -->
            <div class="form-group">
                <label>Giá (VND)</label>
                <input type="number"
                       name="price"
                       th:value="${post.price}"
                       min="0"
                       step="1000"
                       placeholder="Ví dụ: 350000000">
            </div>

            <!-- NỘI DUNG -->
            <div class="form-group">
                <label>Nội dung</label>
                <textarea name="content"
                          rows="6"
                          th:text="${post.content}"
                          style="resize:vertical;padding:9px;border:1px solid #dcdcdc;border-radius:8px;"></textarea>
            </div>

            <!-- HÌNH ẢNH -->
            <div class="form-group">
                <label>Hình ảnh</label>
                <input type="file" name="image" accept="image/*">
                <img th:if="${post.imagePath != null}"
                     th:src="${post.imagePath}"
                     style="margin-top:8px;width:200px;border-radius:10px;">
            </div>

            <!-- NÚT LƯU -->
            <button class="btn-primary"
                    type="submit"
                    th:text="${post.id == null ? 'Đăng tin' : 'Lưu thay đổi'}">
            </button>
        </form>

        <!-- NÚT XOÁ (CHỈ KHI CHỈNH SỬA) -->
        <form th:if="${post.id != null}"
              th:action="@{'/posts/' + ${post.id} + '/delete'}"
              method="post"
              style="margin-top:10px;">
            <button class="btn-outline" onclick="return confirm('Xoá tin?')">Xoá tin</button>
        </form>
    </div>
</div>

<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

</body>
</html>
