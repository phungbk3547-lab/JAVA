<!-- src/main/resources/templates/member/home.html -->
<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>EV Trading | B·∫£ng tin</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script th:src="@{/js/script.js}" defer></script>
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<div class="app-shell">
    <!-- MENU TR√ÅI -->
    <aside class="side-nav">
        <div class="side-nav-group">
            <div class="side-nav-title">B·∫¢NG TIN</div>
            <a th:href="@{/home}" class="side-link active">
                <i class="fa-solid fa-house"></i> Trang ch·ªß
            </a>
            <a th:href="@{/posts}" class="side-link">
                <i class="fa-regular fa-rectangle-list"></i> T·∫•t c·∫£ tin
            </a>
        </div>

        <div class="side-nav-group" sec:authorize="hasRole('USER')">

            <a th:href="@{/member/posts/new}" class="side-link">
                <i class="fa-solid fa-pen-to-square"></i> ƒêƒÉng tin b√°n
            </a>
            <a th:href="@{/member/my-posts}" class="side-link">
                <i class="fa-solid fa-folder-open"></i> Tin c·ªßa t√¥i
            </a>
            <a th:href="@{/member/profile}" class="side-link">
                <i class="fa-regular fa-user"></i> Trang c√° nh√¢n
            </a>
        </div>

        <!-- ‚≠ê CH·ªà ADMIN M·ªöI TH·∫§Y -->
        <div class="side-nav-group" sec:authorize="hasRole('ADMIN')">
            <div class="side-nav-title">QU·∫¢N TR·ªä</div>
            <a th:href="@{/admin/dashboard}" class="side-link">
                <i class="fa-solid fa-gauge-high"></i> Dashboard
            </a>
            <a th:href="@{/admin/complaint}" class="side-link">
                <i class="fa-solid fa-flag"></i> Khi·∫øu n·∫°i
            </a>
        </div>
    </aside>
    <!-- N·ªòI DUNG CH√çNH -->
    <main class="app-content">
        <h1 class="home-title">B·∫£ng tin mua b√°n xe ƒëi·ªán &amp; pin</h1>
        <p class="home-subtitle">
            Xem nhanh c√°c tin m·ªõi nh·∫•t. ƒêƒÉng nh·∫≠p ƒë·ªÉ ƒëƒÉng tin b√°n ho·∫∑c qu·∫£n l√Ω tin c·ªßa b·∫°n.
        </p>

        <!-- THANH FILTER -->
        <form class="posts-filter-bar" th:action="@{/home}" method="get">
            <input class="filter-input" type="text" name="q"
                   placeholder="üîç T√¨m theo ti√™u ƒë·ªÅ, ƒë·ªãa ƒëi·ªÉm..."
                   th:value="${q}">
            <select name="type" class="filter-select">
                <option value="" th:selected="${type == null or type == ''}">T·∫•t c·∫£ lo·∫°i tin</option>
                <option value="EV" th:selected="${type == 'EV'}">Xe ƒëi·ªán</option>
                <option value="PIN" th:selected="${type == 'PIN'}">Pin nƒÉng l∆∞·ª£ng</option>
            </select>
            <button type="submit" class="filter-btn">L·ªçc</button>
            <a th:href="@{/home}" class="filter-reset">Reset</a>
        </form>

        <!-- L∆Ø·ªöI B√ÄI ƒêƒÇNG -->
        <div th:if="${#lists.isEmpty(posts)}">
            Hi·ªán ch∆∞a c√≥ tin n√†o.
        </div>

        <div class="post-grid" th:if="${!#lists.isEmpty(posts)}">
            <div class="post-card" th:each="p : ${posts}">
                <img th:if="${p.imagePath != null}"
                     th:src="@{${p.imagePath}}"
                     alt="·∫¢nh tin"
                     class="post-image">

                <h3 class="post-title" th:text="${p.title}">Ti√™u ƒë·ªÅ</h3>

                <p class="post-meta">
                    <span th:text="${p.location}">ƒê·ªãa ƒëi·ªÉm</span> ‚Ä¢
                    <span th:text="${p.category}">Lo·∫°i</span>
                </p>

                <p class="post-price"
                   th:if="${p.price != null}"
                   th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + ' ƒë'">
                    0 ƒë
                </p>

                <a th:href="@{|/posts/${p.id}|}" class="btn-outline">Xem chi ti·∫øt</a>
            </div>
        </div>
    </main>
</div>

<footer class="footer">
    ¬© 2025 EV Trading Platform ‚ö° ‚Äî N·ªÅn t·∫£ng giao d·ªãch xe ƒëi·ªán &amp; pin ƒë√£ qua s·ª≠ d·ª•ng
</footer>

</body>
</html>
